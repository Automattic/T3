(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,r=window.wp.element,a=window.wp.i18n,s=window.wp.data,n=window.wp.compose,l=window.wp.apiFetch;var m=e.n(l);const o={logoUrl:themeGardenData.logoUrl,themes:themeGardenData.themes,categories:themeGardenData.categories,selectedCategory:themeGardenData.selectedCategory,search:themeGardenData.search,baseUrl:themeGardenData.baseUrl,isFetchingThemes:!1},c={receiveThemes:e=>({type:"RECEIVE_THEMES",themes:e}),prefetchThemes:()=>({type:"PREFETCH_THEMES"}),*fetchThemes(e){try{return console.log("d1"),i.FETCH_THEMES(e)}catch(e){throw new Error("Failed to update settings")}},*searchThemes(e){try{return i.SEARCH_THEMES(e)}catch(e){throw new Error("Failed to update settings")}}},h={getLogoUrl:()=>o.logoUrl,getInitialFilterBarProps:()=>({categories:o.categories,selectedCategory:o.selectedCategory,baseUrl:o.baseUrl,search:o.search}),getIsFetchingThemes:e=>e.isFetchingThemes,getThemes:e=>e.themes},i={FETCH_THEMES:e=>(console.log("d2",e),m()({path:"/tumblr3/v1/themes?category="+e,method:"GET"}).then((e=>(console.log("d3",e),e))).catch((e=>{throw e}))),SEARCH_THEMES:e=>m()({path:"/tumblr3/v1/themes?search="+e,method:"GET"}).then((e=>e)).catch((e=>{throw console.error("API Error:",e),e}))},d=(0,s.createReduxStore)("tumblr3/theme-garden-store",{reducer:(e=o,t)=>{switch(t.type){case"PREFETCH_THEMES":return{...e,isFetchingThemes:!0};case"RECEIVE_THEMES":return{...e,themes:t.themes,isFetchingThemes:!1};default:return e}},actions:c,selectors:h,controls:i,resolvers:{}});(0,s.register)(d);const u=(0,n.compose)((0,s.withSelect)((e=>({initialProps:e("tumblr3/theme-garden-store").getInitialFilterBarProps(),themes:e("tumblr3/theme-garden-store").getThemes()}))),(0,s.withDispatch)((e=>({prefetchThemes:()=>e("tumblr3/theme-garden-store").prefetchThemes(),fetchThemes:t=>e("tumblr3/theme-garden-store").fetchThemes(t),searchThemes:t=>e("tumblr3/theme-garden-store").searchThemes(t),receiveThemes:t=>e("tumblr3/theme-garden-store").receiveThemes(t)}))))((({initialProps:{baseUrl:e,selectedCategory:s,categories:n,search:l},themes:m,fetchThemes:o,receiveThemes:c,prefetchThemes:h,searchThemes:i})=>{const[d,u]=(0,r.useState)(s),[g,E]=(0,r.useState)(l),[p,w]=(0,r.useState)(m),T=(0,r.useRef)();(0,r.useEffect)((()=>{w(m)}),[m]),(0,r.useEffect)((()=>(window.addEventListener("popstate",y),()=>{window.removeEventListener("popstate",y)})),[]);const b=async e=>{h();const t=await o(e);c(t)},y=async()=>{const e=new URLSearchParams(window.location.search),t=e.get("category")||"featured",r=e.get("search")||"";""!==r?E(r):(await b(t),u(t))};return(0,t.createElement)("div",{className:"wp-filter"},(0,t.createElement)("div",{className:"filter-count"},(0,t.createElement)("span",{className:"count"},p.length)),(0,t.createElement)("label",{htmlFor:"t3-categories"},(0,a.__)("Categories","tumblr3")),(0,t.createElement)("select",{id:"t3-categories",name:"category",onChange:async({currentTarget:t})=>{const r=t.value;await b(r),u(r),E(""),window.history.pushState({},"",e+"&category="+r)}},(0,t.createElement)("option",{value:"featured"},(0,a._x)("Featured","The name of a category in a list of categories.","tumblr3")),n.map((e=>(0,t.createElement)("option",{key:e.text_key,value:e.text_key,selected:d===e.text_key},e.name)))),(0,t.createElement)("p",{className:"search-box"},(0,t.createElement)("label",{htmlFor:"wp-filter-search-input"},"Search Themes"),(0,t.createElement)("input",{type:"search","aria-describedby":"live-search-desc",id:"wp-filter-search-input",className:"wp-filter-search",name:"search",value:g,onChange:async({currentTarget:t})=>{const r=t.value;clearTimeout(T.current),E(r),T.current=setTimeout((async()=>{await(async e=>{h();const t=await i(e);c(t)})(r),window.history.pushState({},"",e+"&search="+r),u("")}),500)}})))})),g=()=>{const e=[(0,a._x)("Sadly, nothing.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("Tragically, nothing.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("We found nothing. Here it isn’t.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("Couldn’t find that. Please, don’t be upset. Please.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("Sincerely, we found nothing.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("Nothing to see here.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("If you were looking for nothing, congrats, you found it.","The message displayed when no themes were found.","tumblr3")],r=Math.floor(Math.random()*e.length);return(0,t.createElement)("p",{className:"no-themes",id:"tumblr-no-themes"},e[r])},E=(0,n.compose)((0,s.withSelect)((e=>({themes:e("tumblr3/theme-garden-store").getThemes(),isFetchingThemes:e("tumblr3/theme-garden-store").getIsFetchingThemes()}))))((({themes:e,isFetchingThemes:s})=>{const[n,l]=(0,r.useState)(e);return(0,r.useEffect)((()=>{l(e)}),[e]),s?(0,t.createElement)("div",{className:"loading-content"},(0,t.createElement)("span",{className:"spinner"})):0===n.length?(0,t.createElement)(g,null):(0,t.createElement)("div",{className:"tumblr-themes"},e.map((e=>(0,t.createElement)("article",{className:"tumblr-theme",key:e.title},(0,t.createElement)("header",{className:"tumblr-theme-header"},(0,t.createElement)("div",{className:"tumblr-theme-title-wrapper"},(0,t.createElement)("span",{className:"tumblr-theme-title"},e.title))),(0,t.createElement)("div",{className:"tumblr-theme-content"},(0,t.createElement)("img",{className:"tumblr-theme-thumbnail",src:e.thumbnail,alt:""}),(0,t.createElement)("ul",{className:"tumblr-theme-buttons"},(0,t.createElement)("li",null,(0,t.createElement)("a",{href:e.activate_url},(0,a._x)("Activate","Text on a button to activate a theme.","tumblr3")))))))))})),p=(0,n.compose)((0,s.withSelect)((e=>({logoUrl:e("tumblr3/theme-garden-store").getLogoUrl()}))))((({logoUrl:e})=>(0,t.createElement)("div",{className:"wrap"},(0,t.createElement)("h1",{className:"wp-heading-inline",id:"theme-garden-heading"},(0,t.createElement)("img",{className:"tumblr-logo-icon",src:e,alt:""}),(0,t.createElement)("span",null,(0,a.__)("Tumblr Themes","tumblr3"))),(0,t.createElement)(u,null),(0,t.createElement)(E,null)))),w=document.getElementById("tumblr-theme-garden");w?(0,r.createRoot)(w).render((0,t.createElement)(p,null)):console.error("Failed to find the root element for the settings panel.")})();