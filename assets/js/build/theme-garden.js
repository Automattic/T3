(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,r=window.wp.element,a=window.wp.i18n,l=window.wp.data,s=window.wp.compose,o=window.wp.apiFetch;var m=e.n(o);const n={logoUrl:themeGardenData.logoUrl,themes:themeGardenData.themes,categories:themeGardenData.categories,selectedCategory:themeGardenData.selectedCategory,baseUrl:themeGardenData.baseUrl},c={receiveThemes:e=>({type:"RECEIVE_THEMES",themes:e}),*fetchThemes(e){try{return h.FETCH_THEMES(e)}catch(e){throw new Error("Failed to update settings")}}},i={getLogoUrl:()=>n.logoUrl,getInitialFilterBarProps:()=>({categories:n.categories,selectedCategory:n.selectedCategory,baseUrl:n.baseUrl}),getThemes:e=>e.themes},h={FETCH_THEMES:e=>m()({path:"/tumblr3/v1/themes?category="+e,method:"GET"}).then((e=>e)).catch((e=>{throw console.error("API Error:",e),e}))},d=(0,l.createReduxStore)("tumblr3/theme-garden-store",{reducer:(e=n,t)=>"RECEIVE_THEMES"===t.type?{...e,themes:t.themes}:e,actions:c,selectors:i,controls:h,resolvers:{}});(0,l.register)(d);const u=(0,s.compose)((0,l.withSelect)((e=>({initialProps:e("tumblr3/theme-garden-store").getInitialFilterBarProps(),themes:e("tumblr3/theme-garden-store").getThemes()}))),(0,l.withDispatch)((e=>({fetchThemes:t=>e("tumblr3/theme-garden-store").fetchThemes(t),receiveThemes:t=>e("tumblr3/theme-garden-store").receiveThemes(t)}))))((({initialProps:{baseUrl:e,selectedCategory:l,categories:s},themes:o,fetchThemes:m,receiveThemes:n})=>{const[c,i]=(0,r.useState)(l),[h,d]=(0,r.useState)(o);(0,r.useEffect)((()=>{d(o)}),[o]),(0,r.useEffect)((()=>(window.addEventListener("popstate",u),()=>{window.removeEventListener("popstate",u)})),[]);const u=async()=>{const e=new URLSearchParams(window.location.search).get("category")||"featured",t=await m(e);n(t),i(e)};return(0,t.createElement)("div",{className:"wp-filter"},(0,t.createElement)("div",{className:"filter-count"},(0,t.createElement)("span",{className:"count"},h.length)),(0,t.createElement)("label",{htmlFor:"t3-categories"},(0,a.__)("Categories","tumblr3")),(0,t.createElement)("select",{id:"t3-categories",name:"category",onChange:async({currentTarget:t})=>{try{const r=t.value,a=await m(r);n(a),i(r),window.history.pushState({},"",e+"&category="+t.value)}catch(e){console.error(e)}}},(0,t.createElement)("option",{value:"featured"},(0,a._x)("Featured","The name of a category in a list of categories.","tumblr3")),s.map((e=>(0,t.createElement)("option",{value:e.text_key,selected:c===e.text_key},e.name)))))})),g=(0,s.compose)((0,l.withSelect)((e=>({themes:e("tumblr3/theme-garden-store").getThemes()}))))((({themes:e})=>{const[l,s]=(0,r.useState)(e);return(0,r.useEffect)((()=>{s(e)}),[e]),(0,t.createElement)("div",{className:"tumblr-themes"},e.map((e=>(0,t.createElement)("article",{className:"tumblr-theme"},(0,t.createElement)("header",{className:"tumblr-theme-header"},(0,t.createElement)("div",{className:"tumblr-theme-title-wrapper"},(0,t.createElement)("span",{className:"tumblr-theme-title"},e.title))),(0,t.createElement)("div",{className:"tumblr-theme-content"},(0,t.createElement)("img",{className:"tumblr-theme-thumbnail",src:e.thumbnail}),(0,t.createElement)("ul",{className:"tumblr-theme-buttons"},(0,t.createElement)("li",null,(0,t.createElement)("a",{href:e.activate_url},(0,a._x)("Activate","Text on a button to activate a theme.","tumblr3")))))))))})),E=(0,s.compose)((0,l.withSelect)((e=>({logoUrl:e("tumblr3/theme-garden-store").getLogoUrl()}))))((({logoUrl:e})=>(0,t.createElement)("div",{className:"wrap"},(0,t.createElement)("h1",{className:"wp-heading-inline",id:"theme-garden-heading"},(0,t.createElement)("img",{className:"tumblr-logo-icon",src:e,alt:""}),(0,t.createElement)("span",null,(0,a.__)("Tumblr Themes","tumblr3"))),(0,t.createElement)(u,null),(0,t.createElement)(g,null)))),p=document.getElementById("tumblr-theme-garden");p?(0,r.createRoot)(p).render((0,t.createElement)(E,null)):console.error("Failed to find the root element for the settings panel.")})();