(()=>{var e={942:(e,t)=>{var a;!function(){"use strict";var r={}.hasOwnProperty;function s(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=h(e,n(a)))}return e}function n(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return s.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)r.call(e,a)&&e[a]&&(t=h(t,a));return t}function h(e,t){return t?e?e+" "+t:e+t:e}e.exports?(s.default=s,e.exports=s):void 0===(a=function(){return s}.apply(t,[]))||(e.exports=a)}()}},t={};function a(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.React,t=window.wp.element,r=window.wp.i18n,s=window.wp.data,n=window.wp.compose,h=window.wp.apiFetch;var m=a.n(h);const l={logoUrl:themeGardenData.logoUrl,categories:themeGardenData.categories,baseUrl:themeGardenData.baseUrl,themes:themeGardenData.themes,selectedCategory:themeGardenData.selectedCategory,search:themeGardenData.search,selectedThemeId:themeGardenData.selectedThemeId,themeDetails:themeGardenData.themeDetails,isFetchingThemes:!1,isOverlayOpen:!!themeGardenData.selectedThemeId,isFetchingTheme:!1},c={closeOverlay:()=>({type:"CLOSE_OVERLAY"}),receiveTheme:(e,t)=>({type:"RECEIVE_THEME",theme:e,id:t}),receiveThemes:(e,t,a)=>({type:"RECEIVE_THEMES",themes:e,category:t,search:a}),beforeFetchTheme:()=>({type:"BEFORE_FETCH_THEME"}),beforeFetchThemes:()=>({type:"BEFORE_FETCH_THEMES"}),*fetchThemes(e){try{return i.FETCH_THEMES(e)}catch(e){throw new Error("Failed to fetch themes")}},*searchThemes(e){try{return i.SEARCH_THEMES(e)}catch(e){throw new Error("Failed to search themes")}},*fetchTheme(e){try{return i.FETCH_THEME(e)}catch(e){throw new Error("Failed to fetch theme")}}},o={getBaseUrl:()=>l.baseUrl,getCategories:()=>l.categories,getLogoUrl:()=>l.logoUrl,getSelectedCategory:e=>e.selectedCategory,getSearch:e=>e.search,getIsFetchingThemes:e=>e.isFetchingThemes,getIsFetchingTheme:e=>e.isFetchingTheme,getThemes:e=>e.themes,getIsOverlayOpen:e=>e.isOverlayOpen,getThemeDetails:e=>e.themeDetails},i={FETCH_THEMES:e=>m()({path:"/ttgarden/v1/themes?category="+e,method:"GET"}).then((e=>e)).catch((e=>{throw e})),SEARCH_THEMES:e=>m()({path:"/ttgarden/v1/themes?search="+e,method:"GET"}).then((e=>e)).catch((e=>{throw console.error("API Error:",e),e})),FETCH_THEME:e=>m()({path:"/ttgarden/v1/theme?theme="+e,method:"GET"}).then((e=>e)).catch((e=>{throw console.error("API Error:",e),e}))},d=(0,s.createReduxStore)("tumblr-theme-garden/theme-garden-store",{reducer:(e=l,t)=>{switch(t.type){case"BEFORE_FETCH_THEMES":return{...e,isFetchingThemes:!0};case"BEFORE_FETCH_THEME":return{...e,isFetchingTheme:!0,isOverlayOpen:!0};case"RECEIVE_THEMES":return{...e,themes:t.themes,isFetchingThemes:!1,selectedCategory:t.category,search:t.search};case"RECEIVE_THEME":return{...e,isFetchingTheme:!1,themeDetails:t.theme,selectedThemeId:t.id};case"CLOSE_OVERLAY":return{...e,isOverlayOpen:!1,isFetchingTheme:!1,themeDetails:null};default:return e}},actions:c,selectors:o,controls:i});(0,s.register)(d);const g=(0,n.compose)((0,s.withSelect)((e=>({baseUrl:e("tumblr-theme-garden/theme-garden-store").getBaseUrl(),selectedCategory:e("tumblr-theme-garden/theme-garden-store").getSelectedCategory(),categories:e("tumblr-theme-garden/theme-garden-store").getCategories(),search:e("tumblr-theme-garden/theme-garden-store").getSearch(),themes:e("tumblr-theme-garden/theme-garden-store").getThemes()}))))((({baseUrl:a,selectedCategory:s,categories:n,search:h,themes:m,fetchThemesByQuery:l,fetchThemesByCategory:c})=>{const[o,i]=(0,t.useState)(s),[d,g]=(0,t.useState)(h),[u,E]=(0,t.useState)(m),p=(0,t.useRef)();return(0,t.useEffect)((()=>{E(m)}),[m]),(0,t.useEffect)((()=>{i(s)}),[s]),(0,t.useEffect)((()=>{g(h)}),[h]),(0,e.createElement)("div",{className:"wp-filter"},(0,e.createElement)("div",{className:"filter-count"},(0,e.createElement)("span",{className:"count"},u.length)),(0,e.createElement)("label",{htmlFor:"t3-categories"},(0,r._x)("Categories","label for a dropdown list of theme categories","tumblr-theme-garden")),(0,e.createElement)("select",{id:"t3-categories",name:"category",onChange:async({currentTarget:e})=>{const t=e.value;i(t),await c(t),window.history.pushState({},"",a+"&category="+t)}},(0,e.createElement)("option",{value:"featured"},(0,r._x)("Featured","The name of a category in a list of categories.","tumblr-theme-garden")),n.map((t=>(0,e.createElement)("option",{key:t.text_key,value:t.text_key,selected:o===t.text_key},t.name)))),(0,e.createElement)("p",{className:"search-box"},(0,e.createElement)("label",{htmlFor:"wp-filter-search-input"},(0,r._x)("Search Themes","label for a text input","tumblr-theme-garden")),(0,e.createElement)("input",{type:"search","aria-describedby":"live-search-desc",id:"wp-filter-search-input",className:"wp-filter-search",name:"search",value:d,onChange:async({currentTarget:e})=>{const t=e.value;g(t),clearTimeout(p.current),p.current=setTimeout((async()=>{await l(t),window.history.pushState({},"",a+"&search="+t)}),500)}})))})),u=()=>{const t=[(0,r._x)("Sadly, nothing.","The message displayed when no themes were found.","ttgarden"),(0,r._x)("Tragically, nothing.","The message displayed when no themes were found.","ttgarden"),(0,r._x)("We found nothing. Here it isn’t.","The message displayed when no themes were found.","ttgarden"),(0,r._x)("Couldn’t find that. Please, don’t be upset. Please.","The message displayed when no themes were found.","ttgarden"),(0,r._x)("Sincerely, we found nothing.","The message displayed when no themes were found.","ttgarden"),(0,r._x)("Nothing to see here.","The message displayed when no themes were found.","ttgarden"),(0,r._x)("If you were looking for nothing, congrats, you found it.","The message displayed when no themes were found.","ttgarden")],a=Math.floor(Math.random()*t.length);return(0,e.createElement)("p",{className:"no-themes",id:"tumblr-no-themes"},t[a])},E=(0,n.compose)((0,s.withSelect)((e=>({themes:e("tumblr-theme-garden/theme-garden-store").getThemes(),isFetchingThemes:e("tumblr-theme-garden/theme-garden-store").getIsFetchingThemes()}))),(0,s.withDispatch)((e=>({closeOverlay:()=>e("tumblr-theme-garden/theme-garden-store").closeOverlay()}))))((({themes:a,isFetchingThemes:s,fetchThemeById:n})=>{const[h,m]=(0,t.useState)(a);(0,t.useEffect)((()=>{m(a)}),[a]);const l=async({currentTarget:{value:e}})=>{const t=new URL(window.location.href),a=new URLSearchParams(t.search);a.append("theme",e),t.search=a.toString(),await n(e),window.history.pushState({},"",t.toString())};return s?(0,e.createElement)("div",{className:"loading-content"},(0,e.createElement)("span",{className:"spinner"})):0===h.length?(0,e.createElement)(u,null):(0,e.createElement)("div",{className:"tumblr-themes"},a.map((t=>{const a=`tumblr-theme-garden-theme-details-${t.id}`;return(0,e.createElement)("article",{className:"tumblr-theme",key:t.title},(0,e.createElement)("header",{className:"tumblr-theme-header"},(0,e.createElement)("div",{className:"tumblr-theme-title-wrapper"},(0,e.createElement)("span",{className:"tumblr-theme-title"},t.title))),(0,e.createElement)("div",{className:"tumblr-theme-content"},(0,e.createElement)("button",{className:"tumblr-theme-details",onClick:l,value:t.id,id:a},(0,e.createElement)("label",{htmlFor:a},(0,e.createElement)("span",{className:"tumblr-theme-detail-button"},(0,r._x)("Theme details","Text on a button that will show more information about a Tumblr theme","tumblr-theme-garden"))),(0,e.createElement)("img",{src:t.thumbnail,alt:""})),(0,e.createElement)("div",{className:"tumblr-theme-footer"},(0,e.createElement)("a",{className:"rainbow-button",href:t.activate_url},"Activate"))))})))}));var p=a(942),w=a.n(p);const T=(0,n.compose)((0,s.withSelect)((e=>({themes:e("tumblr-theme-garden/theme-garden-store").getThemes(),isOverlayOpen:e("tumblr-theme-garden/theme-garden-store").getIsOverlayOpen(),isFetchingTheme:e("tumblr-theme-garden/theme-garden-store").getIsFetchingTheme(),themeDetails:e("tumblr-theme-garden/theme-garden-store").getThemeDetails()}))),(0,s.withDispatch)((e=>({closeOverlay:()=>e("tumblr-theme-garden/theme-garden-store").closeOverlay()}))))((({themes:a,isOverlayOpen:s,isFetchingTheme:n,closeOverlay:h,themeDetails:m,fetchThemeById:l})=>{const c=(0,t.useCallback)((()=>{const e=new URL(window.location.href),t=new URLSearchParams(e.search);t.delete("theme"),e.search=t.toString(),window.history.pushState({},"",e.toString()),h()}),[h]),o=(0,t.useCallback)((()=>n||!m?(0,e.createElement)("div",{className:"loading-content wp-clearfix"},(0,e.createElement)("span",{className:"spinner"})):(0,e.createElement)("div",{className:"theme-about wp-clearfix"},(0,e.createElement)("div",{className:"theme-screenshots"},(0,e.createElement)("div",{className:"screenshot"},(0,e.createElement)("img",{src:m.screenshots[0],alt:""}))),(0,e.createElement)("div",{className:"theme-info"},(0,e.createElement)("h2",{className:"theme-name"},m.title),(0,e.createElement)("div",{dangerouslySetInnerHTML:{__html:m.description}})))),[m,n]),i=(0,t.useCallback)((async e=>{const t=new URL(window.location.href),r=new URLSearchParams(t.search),s=a[e].id;r.delete("theme"),r.append("theme",s),t.search=r.toString(),await l(s),window.history.pushState({},"",t.toString())}),[a,l]),d=(0,t.useCallback)((()=>{const t=a.findIndex((e=>e.id===m.id)),s=-1===t||0===t,n=-1===t||t===a.length-1;return(0,e.createElement)("div",{className:"theme-header"},(0,e.createElement)("button",{className:w()("left","dashicons","dashicons-no",{disabled:s}),disabled:s,onClick:()=>i(t-1)},(0,e.createElement)("span",{className:"screen-reader-text"},(0,r._x)("Show previous theme","label for a button that will navigate to previous theme","tumblr-theme-garden"))),(0,e.createElement)("button",{className:w()("right","dashicons","dashicons-no",{disabled:n}),disabled:n,onClick:()=>i(t+1)},(0,e.createElement)("span",{className:"screen-reader-text"},(0,r._x)("Show next theme","label for a button that will navigate to next theme","tumblr-theme-garden"))),(0,e.createElement)("button",{className:"close dashicons dashicons-no",onClick:c},(0,e.createElement)("span",{className:"screen-reader-text"},(0,r._x)("Close theme details overlay","label for a button that will close an overlay","tumblr-theme-garden"))))}),[m,a,i,c]);return s&&m?(0,e.createElement)("div",{className:"theme-overlay",id:"tumblr-theme-overlay"},(0,e.createElement)("div",{className:"theme-backdrop"}),(0,e.createElement)("div",{className:"theme-wrap wp-clearfix"},d(),o())):null})),b=(0,n.compose)((0,s.withSelect)((e=>({logoUrl:e("tumblr-theme-garden/theme-garden-store").getLogoUrl(),selectedCategory:e("tumblr-theme-garden/theme-garden-store").getSelectedCategory(),search:e("tumblr-theme-garden/theme-garden-store").getSearch()}))),(0,s.withDispatch)((e=>({beforeFetchThemes:()=>e("tumblr-theme-garden/theme-garden-store").beforeFetchThemes(),fetchThemes:t=>e("tumblr-theme-garden/theme-garden-store").fetchThemes(t),searchThemes:t=>e("tumblr-theme-garden/theme-garden-store").searchThemes(t),receiveThemes:(t,a,r)=>e("tumblr-theme-garden/theme-garden-store").receiveThemes(t,a,r),beforeFetchTheme:()=>e("tumblr-theme-garden/theme-garden-store").beforeFetchTheme(),fetchTheme:t=>e("tumblr-theme-garden/theme-garden-store").fetchTheme(t),receiveTheme:(t,a)=>e("tumblr-theme-garden/theme-garden-store").receiveTheme(t,a),closeOverlay:()=>e("tumblr-theme-garden/theme-garden-store").closeOverlay()}))))((({logoUrl:a,beforeFetchThemes:s,fetchThemes:n,receiveThemes:h,searchThemes:m,beforeFetchTheme:l,fetchTheme:c,receiveTheme:o,closeOverlay:i,search:d,selectedCategory:u})=>{const p=(0,t.useCallback)((async e=>{s();const t=await n(e);h(t,e,"")}),[s,h,n]),w=(0,t.useCallback)((async e=>{s();const t=await m(e);h(t,"",e)}),[s,h,m]),b=(0,t.useCallback)((async()=>{const e=new URLSearchParams(window.location.search),t=e.get("category")||"featured",a=e.get("search")||"",r=e.get("theme")||"";if(""!==a&&a!==d?await w(a):""!==t&&t!==u&&await p(t),""!==r){l();const e=await c(r);o(e,r)}else i()}),[u,d,l,i,c,p,w,o]);(0,t.useEffect)((()=>(window.addEventListener("popstate",b),()=>{window.removeEventListener("popstate",b)})),[b]);const y=(0,t.useCallback)((async e=>{l();const t=await c(e);o(t,e)}),[l,o,c]);return(0,e.createElement)("div",{className:"wrap"},(0,e.createElement)("h1",{className:"wp-heading-inline",id:"theme-garden-heading"},(0,e.createElement)("img",{className:"tumblr-logo-icon",src:a,alt:""}),(0,e.createElement)("span",null,(0,r.__)("Tumblr Themes","tumblr-theme-garden"))),(0,e.createElement)(g,{fetchThemesByCategory:p,fetchThemesByQuery:w}),(0,e.createElement)(E,{fetchThemeById:y}),(0,e.createElement)(T,{fetchThemeById:y}))})),y=document.getElementById("tumblr-theme-garden");y?(0,t.createRoot)(y).render((0,e.createElement)(b,null)):console.error("Failed to find the root element for the settings panel.")})()})();