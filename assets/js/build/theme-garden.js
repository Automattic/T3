(()=>{var e={942:(e,t)=>{var r;!function(){"use strict";var a={}.hasOwnProperty;function s(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=l(e,n(r)))}return e}function n(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return s.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)a.call(e,r)&&e[r]&&(t=l(t,r));return t}function l(e,t){return t?e?e+" "+t:e+t:e}e.exports?(s.default=s,e.exports=s):void 0===(r=function(){return s}.apply(t,[]))||(e.exports=r)}()}},t={};function r(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.React,t=window.wp.element,a=window.wp.i18n,s=window.wp.data,n=window.wp.compose,l=window.wp.apiFetch;var c=r.n(l);const h={logoUrl:themeGardenData.logoUrl,categories:themeGardenData.categories,baseUrl:themeGardenData.baseUrl,themes:themeGardenData.themes,selectedCategory:themeGardenData.selectedCategory,search:themeGardenData.search,selectedThemeId:themeGardenData.selectedThemeId,themeDetails:themeGardenData.themeDetails,isFetchingThemes:!1,isOverlayOpen:!!themeGardenData.selectedThemeId,isFetchingTheme:!1},o={closeOverlay:()=>({type:"CLOSE_OVERLAY"}),receiveTheme:(e,t)=>({type:"RECEIVE_THEME",theme:e,id:t}),receiveThemes:(e,t,r)=>({type:"RECEIVE_THEMES",themes:e,category:t,search:r}),beforeFetchTheme:()=>({type:"BEFORE_FETCH_THEME"}),beforeFetchThemes:()=>({type:"BEFORE_FETCH_THEMES"}),*fetchThemes(e){try{return i.FETCH_THEMES(e)}catch(e){throw new Error("Failed to fetch themes")}},*searchThemes(e){try{return i.SEARCH_THEMES(e)}catch(e){throw new Error("Failed to search themes")}},*fetchTheme(e){try{return i.FETCH_THEME(e)}catch(e){throw new Error("Failed to fetch theme")}}},m={getBaseUrl:()=>h.baseUrl,getCategories:()=>h.categories,getLogoUrl:()=>h.logoUrl,getSelectedCategory:e=>e.selectedCategory,getSearch:e=>e.search,getIsFetchingThemes:e=>e.isFetchingThemes,getIsFetchingTheme:e=>e.isFetchingTheme,getThemes:e=>e.themes,getIsOverlayOpen:e=>e.isOverlayOpen,getThemeDetails:e=>e.themeDetails},i={FETCH_THEMES:e=>c()({path:"/tumblr3/v1/themes?category="+e,method:"GET"}).then((e=>e)).catch((e=>{throw e})),SEARCH_THEMES:e=>c()({path:"/tumblr3/v1/themes?search="+e,method:"GET"}).then((e=>e)).catch((e=>{throw console.error("API Error:",e),e})),FETCH_THEME:e=>c()({path:"/tumblr3/v1/theme?theme="+e,method:"GET"}).then((e=>e)).catch((e=>{throw console.error("API Error:",e),e}))},d=(0,s.createReduxStore)("tumblr3/theme-garden-store",{reducer:(e=h,t)=>{switch(t.type){case"BEFORE_FETCH_THEMES":return{...e,isFetchingThemes:!0};case"BEFORE_FETCH_THEME":return{...e,isFetchingTheme:!0,isOverlayOpen:!0};case"RECEIVE_THEMES":return{...e,themes:t.themes,isFetchingThemes:!1,selectedCategory:t.category,search:t.search};case"RECEIVE_THEME":return{...e,isFetchingTheme:!1,themeDetails:t.theme,selectedThemeId:t.id};case"CLOSE_OVERLAY":return{...e,isOverlayOpen:!1,isFetchingTheme:!1,themeDetails:null};default:return e}},actions:o,selectors:m,controls:i});(0,s.register)(d);const u=(0,n.compose)((0,s.withSelect)((e=>({baseUrl:e("tumblr3/theme-garden-store").getBaseUrl(),selectedCategory:e("tumblr3/theme-garden-store").getSelectedCategory(),categories:e("tumblr3/theme-garden-store").getCategories(),search:e("tumblr3/theme-garden-store").getSearch(),themes:e("tumblr3/theme-garden-store").getThemes()}))))((({baseUrl:r,selectedCategory:s,categories:n,search:l,themes:c,fetchThemesByQuery:h,fetchThemesByCategory:o})=>{const[m,i]=(0,t.useState)(s),[d,u]=(0,t.useState)(l),[g,E]=(0,t.useState)(c),p=(0,t.useRef)();return(0,t.useEffect)((()=>{E(c)}),[c]),(0,t.useEffect)((()=>{i(s)}),[s]),(0,t.useEffect)((()=>{u(l)}),[l]),(0,e.createElement)("div",{className:"wp-filter"},(0,e.createElement)("div",{className:"filter-count"},(0,e.createElement)("span",{className:"count"},g.length)),(0,e.createElement)("label",{htmlFor:"t3-categories"},(0,a._x)("Categories","label for a dropdown list of theme categories","tumblr3")),(0,e.createElement)("select",{id:"t3-categories",name:"category",onChange:async({currentTarget:e})=>{const t=e.value;i(t),await o(t),window.history.pushState({},"",r+"&category="+t)}},(0,e.createElement)("option",{value:"featured"},(0,a._x)("Featured","The name of a category in a list of categories.","tumblr3")),n.map((t=>(0,e.createElement)("option",{key:t.text_key,value:t.text_key,selected:m===t.text_key},t.name)))),(0,e.createElement)("p",{className:"search-box"},(0,e.createElement)("label",{htmlFor:"wp-filter-search-input"},(0,a._x)("Search Themes","label for a text input","tumblr3")),(0,e.createElement)("input",{type:"search","aria-describedby":"live-search-desc",id:"wp-filter-search-input",className:"wp-filter-search",name:"search",value:d,onChange:async({currentTarget:e})=>{const t=e.value;u(t),clearTimeout(p.current),p.current=setTimeout((async()=>{await h(t),window.history.pushState({},"",r+"&search="+t)}),500)}})))})),g=()=>{const t=[(0,a._x)("Sadly, nothing.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("Tragically, nothing.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("We found nothing. Here it isn’t.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("Couldn’t find that. Please, don’t be upset. Please.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("Sincerely, we found nothing.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("Nothing to see here.","The message displayed when no themes were found.","tumblr3"),(0,a._x)("If you were looking for nothing, congrats, you found it.","The message displayed when no themes were found.","tumblr3")],r=Math.floor(Math.random()*t.length);return(0,e.createElement)("p",{className:"no-themes",id:"tumblr-no-themes"},t[r])},E=(0,n.compose)((0,s.withSelect)((e=>({themes:e("tumblr3/theme-garden-store").getThemes(),isFetchingThemes:e("tumblr3/theme-garden-store").getIsFetchingThemes()}))),(0,s.withDispatch)((e=>({closeOverlay:()=>e("tumblr3/theme-garden-store").closeOverlay()}))))((({themes:r,isFetchingThemes:s,fetchThemeById:n})=>{const[l,c]=(0,t.useState)(r);(0,t.useEffect)((()=>{c(r)}),[r]);const h=async({currentTarget:{value:e}})=>{const t=new URL(window.location.href),r=new URLSearchParams(t.search);r.append("theme",e),t.search=r.toString(),await n(e),window.history.pushState({},"",t.toString())};return s?(0,e.createElement)("div",{className:"loading-content"},(0,e.createElement)("span",{className:"spinner"})):0===l.length?(0,e.createElement)(g,null):(0,e.createElement)("div",{className:"tumblr-themes"},r.map((t=>(0,e.createElement)("article",{className:"tumblr-theme",key:t.title},(0,e.createElement)("header",{className:"tumblr-theme-header"},(0,e.createElement)("div",{className:"tumblr-theme-title-wrapper"},(0,e.createElement)("span",{className:"tumblr-theme-title"},t.title))),(0,e.createElement)("div",{className:"tumblr-theme-content"},(0,e.createElement)("button",{className:"tumblr-theme-details",onClick:h,value:t.id},(0,e.createElement)("label",null,(0,e.createElement)("span",{className:"tumblr-theme-detail-button"},(0,a._x)("Theme details","Text on a button that will show more information about a Tumblr theme","tumblr3"))),(0,e.createElement)("img",{src:t.thumbnail,alt:""})),(0,e.createElement)("div",{className:"tumblr-theme-footer"},(0,e.createElement)("a",{className:"rainbow-button",href:t.activate_url},"Activate")))))))}));var p=r(942),b=r.n(p);const w=(0,n.compose)((0,s.withSelect)((e=>({themes:e("tumblr3/theme-garden-store").getThemes(),isOverlayOpen:e("tumblr3/theme-garden-store").getIsOverlayOpen(),isFetchingTheme:e("tumblr3/theme-garden-store").getIsFetchingTheme(),themeDetails:e("tumblr3/theme-garden-store").getThemeDetails()}))),(0,s.withDispatch)((e=>({closeOverlay:()=>e("tumblr3/theme-garden-store").closeOverlay()}))))((({themes:r,isOverlayOpen:s,isFetchingTheme:n,closeOverlay:l,themeDetails:c,fetchThemeById:h})=>{const o=()=>{const e=new URL(window.location.href),t=new URLSearchParams(e.search);t.delete("theme"),e.search=t.toString(),window.history.pushState({},"",e.toString()),l()},m=(0,t.useCallback)((()=>n||!c?(0,e.createElement)("div",{className:"loading-content wp-clearfix"},(0,e.createElement)("span",{className:"spinner"})):(0,e.createElement)("div",{className:"theme-about wp-clearfix"},(0,e.createElement)("div",{className:"theme-screenshots"},(0,e.createElement)("div",{className:"screenshot"},(0,e.createElement)("img",{src:c.screenshots[0],alt:""}))),(0,e.createElement)("div",{className:"theme-info"},(0,e.createElement)("h2",{className:"theme-name"},c.title),(0,e.createElement)("div",{dangerouslySetInnerHTML:{__html:c.description}})))),[c,n]),i=(0,t.useCallback)((async e=>{const t=new URL(window.location.href),a=new URLSearchParams(t.search),s=r[e].id;a.delete("theme"),a.append("theme",s),t.search=a.toString(),await h(s),window.history.pushState({},"",t.toString())}),[r]),d=(0,t.useCallback)((()=>{const t=r.findIndex((e=>e.id===c.id)),s=!t||0===t,n=t===r.length-1;return(0,e.createElement)("div",{className:"theme-header"},(0,e.createElement)("button",{className:b()("left","dashicons","dashicons-no",{disabled:s}),disabled:s,onClick:()=>i(t-1)},(0,e.createElement)("span",{className:"screen-reader-text"},(0,a._x)("Show previous theme","label for a button that will navigate to previous theme","tumblr3"))),(0,e.createElement)("button",{className:b()("right","dashicons","dashicons-no",{disabled:n}),disabled:n,onClick:()=>i(t+1)},(0,e.createElement)("span",{className:"screen-reader-text"},(0,a._x)("Show next theme","label for a button that will navigate to next theme","tumblr3"))),(0,e.createElement)("button",{className:"close dashicons dashicons-no",onClick:o},(0,e.createElement)("span",{className:"screen-reader-text"},(0,a._x)("Close theme details overlay","label for a button that will close an overlay","tumblr3"))))}),[c,r,i]);return s&&c?(0,e.createElement)("div",{className:"theme-overlay",id:"tumblr-theme-overlay"},(0,e.createElement)("div",{className:"theme-backdrop"}),(0,e.createElement)("div",{className:"theme-wrap wp-clearfix"},d(),m())):null})),T=(0,n.compose)((0,s.withSelect)((e=>({logoUrl:e("tumblr3/theme-garden-store").getLogoUrl()}))),(0,s.withDispatch)((e=>({beforeFetchThemes:()=>e("tumblr3/theme-garden-store").beforeFetchThemes(),fetchThemes:t=>e("tumblr3/theme-garden-store").fetchThemes(t),searchThemes:t=>e("tumblr3/theme-garden-store").searchThemes(t),receiveThemes:(t,r,a)=>e("tumblr3/theme-garden-store").receiveThemes(t,r,a),beforeFetchTheme:()=>e("tumblr3/theme-garden-store").beforeFetchTheme(),fetchTheme:t=>e("tumblr3/theme-garden-store").fetchTheme(t),receiveTheme:(t,r)=>e("tumblr3/theme-garden-store").receiveTheme(t,r),closeOverlay:()=>e("tumblr3/theme-garden-store").closeOverlay()}))))((({logoUrl:r,beforeFetchThemes:s,fetchThemes:n,receiveThemes:l,searchThemes:c,beforeFetchTheme:h,fetchTheme:o,receiveTheme:m,closeOverlay:i})=>{(0,t.useEffect)((()=>(window.addEventListener("popstate",b),()=>{window.removeEventListener("popstate",b)})),[]);const d=async e=>{s();const t=await n(e);l(t,e,"")},g=async e=>{s();const t=await c(e);l(t,"",e)},p=async e=>{h();const t=await o(e);m(t,e)},b=async()=>{const e=new URLSearchParams(window.location.search),t=e.get("category")||"featured",r=e.get("search")||"",a=e.get("theme")||"";if(console.info("detected browser navigation"),""!==r?(console.info("fetching themes by search"),await g(r)):""!==t&&(console.info("fetching themes by category"),await d(t)),""!==a){h();const e=await o(a);m(e,a)}else i()};return(0,e.createElement)("div",{className:"wrap"},(0,e.createElement)("h1",{className:"wp-heading-inline",id:"theme-garden-heading"},(0,e.createElement)("img",{className:"tumblr-logo-icon",src:r,alt:""}),(0,e.createElement)("span",null,(0,a.__)("Tumblr Themes","tumblr3"))),(0,e.createElement)(u,{fetchThemesByCategory:d,fetchThemesByQuery:g}),(0,e.createElement)(E,{fetchThemeById:p}),(0,e.createElement)(w,{fetchThemeById:p}))})),f=document.getElementById("tumblr-theme-garden");f?(0,t.createRoot)(f).render((0,e.createElement)(T,null)):console.error("Failed to find the root element for the settings panel.")})()})();