(()=>{var e={942:(e,t)=>{var a;!function(){"use strict";var r={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=m(e,s(a)))}return e}function s(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)r.call(e,a)&&e[a]&&(t=m(t,a));return t}function m(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a)}()}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,a),s.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.React,t=window.wp.element,r=window.wp.i18n,n=window.wp.data,s=window.wp.compose,m=window.wp.apiFetch;var h=a.n(m);const l={logoUrl:themeGardenData.logoUrl,categories:themeGardenData.categories,baseUrl:themeGardenData.baseUrl,activeTheme:themeGardenData.activeTheme,themes:themeGardenData.themes,selectedCategory:themeGardenData.selectedCategory,search:themeGardenData.search,selectedThemeId:themeGardenData.selectedThemeId,themeDetails:themeGardenData.themeDetails,isFetchingThemes:!1,isOverlayOpen:!!themeGardenData.selectedThemeId,isFetchingTheme:!1},c={closeOverlay:()=>({type:"CLOSE_OVERLAY"}),receiveTheme:(e,t)=>({type:"RECEIVE_THEME",theme:e,id:t}),receiveThemes:(e,t,a)=>({type:"RECEIVE_THEMES",themes:e,category:t,search:a}),beforeFetchTheme:()=>({type:"BEFORE_FETCH_THEME"}),beforeFetchThemes:()=>({type:"BEFORE_FETCH_THEMES"}),*fetchThemes(e){try{return i.FETCH_THEMES(e)}catch(e){throw new Error("Failed to fetch themes")}},*searchThemes(e){try{return i.SEARCH_THEMES(e)}catch(e){throw new Error("Failed to search themes")}},*fetchTheme(e){try{return i.FETCH_THEME(e)}catch(e){throw new Error("Failed to fetch theme")}}},o={getBaseUrl:()=>l.baseUrl,getCategories:()=>l.categories,getLogoUrl:()=>l.logoUrl,getSelectedCategory:e=>e.selectedCategory,getSearch:e=>e.search,getIsFetchingThemes:e=>e.isFetchingThemes,getIsFetchingTheme:e=>e.isFetchingTheme,getThemes:e=>e.themes.filter((t=>parseInt(t.id)!==parseInt(e.activeTheme.id))),getIsOverlayOpen:e=>e.isOverlayOpen,getThemeDetails:e=>e.themeDetails,getActiveTheme:e=>e.activeTheme},i={FETCH_THEMES:e=>h()({path:"/tumblr-theme-garden/v1/themes?category="+e,method:"GET"}).then((e=>e)).catch((e=>{throw e})),SEARCH_THEMES:e=>h()({path:"/tumblr-theme-garden/v1/themes?search="+e,method:"GET"}).then((e=>e)).catch((e=>{throw console.error("API Error:",e),e})),FETCH_THEME:e=>h()({path:"/tumblr-theme-garden/v1/theme?theme="+e,method:"GET"}).then((e=>e)).catch((e=>{throw console.error("API Error:",e),e}))},d=(0,n.createReduxStore)("tumblr-theme-garden/theme-garden-store",{reducer:(e=l,t)=>{switch(t.type){case"BEFORE_FETCH_THEMES":return{...e,isFetchingThemes:!0};case"BEFORE_FETCH_THEME":return{...e,isFetchingTheme:!0,isOverlayOpen:!0};case"RECEIVE_THEMES":return{...e,themes:t.themes,isFetchingThemes:!1,selectedCategory:t.category,search:t.search};case"RECEIVE_THEME":return{...e,isFetchingTheme:!1,themeDetails:t.theme,selectedThemeId:t.id};case"CLOSE_OVERLAY":return{...e,isOverlayOpen:!1,isFetchingTheme:!1,themeDetails:null};default:return e}},actions:c,selectors:o,controls:i});(0,n.register)(d);const g=(0,s.compose)((0,n.withSelect)((e=>({baseUrl:e("tumblr-theme-garden/theme-garden-store").getBaseUrl(),selectedCategory:e("tumblr-theme-garden/theme-garden-store").getSelectedCategory(),categories:e("tumblr-theme-garden/theme-garden-store").getCategories(),search:e("tumblr-theme-garden/theme-garden-store").getSearch(),themes:e("tumblr-theme-garden/theme-garden-store").getThemes()}))))((({baseUrl:a,selectedCategory:n,categories:s,search:m,themes:h,fetchThemesByQuery:l,fetchThemesByCategory:c})=>{const[o,i]=(0,t.useState)(n),[d,g]=(0,t.useState)(m),[u,E]=(0,t.useState)(h),b=(0,t.useRef)();return(0,t.useEffect)((()=>{E(h)}),[h]),(0,t.useEffect)((()=>{i(n)}),[n]),(0,t.useEffect)((()=>{g(m)}),[m]),(0,e.createElement)("div",{className:"wp-filter"},(0,e.createElement)("div",{className:"filter-count"},(0,e.createElement)("span",{className:"count"},u.length)),(0,e.createElement)("label",{htmlFor:"tumblr-theme-garden-categories"},(0,r._x)("Categories","label for a dropdown list of theme categories","tumblr-theme-garden")),(0,e.createElement)("select",{id:"tumblr-theme-garden-categories",name:"category",onChange:async({currentTarget:e})=>{const t=e.value;i(t),await c(t),window.history.pushState({},"",a+"&category="+t)}},(0,e.createElement)("option",{value:"featured"},(0,r._x)("Featured","The name of a category in a list of categories.","tumblr-theme-garden")),s.map((t=>(0,e.createElement)("option",{key:t.text_key,value:t.text_key,selected:o===t.text_key},t.name)))),(0,e.createElement)("p",{className:"search-box"},(0,e.createElement)("label",{htmlFor:"wp-filter-search-input"},(0,r._x)("Search Themes","label for a text input","tumblr-theme-garden")),(0,e.createElement)("input",{type:"search","aria-describedby":"live-search-desc",id:"wp-filter-search-input",className:"wp-filter-search",name:"search",value:d,onChange:async({currentTarget:e})=>{const t=e.value;g(t),clearTimeout(b.current),b.current=setTimeout((async()=>{await l(t),window.history.pushState({},"",a+"&search="+t)}),800)}})))})),u=()=>{const t=[(0,r._x)("Sadly, nothing.","The message displayed when no themes were found.","tumblr-theme-garden"),(0,r._x)("Tragically, nothing.","The message displayed when no themes were found.","tumblr-theme-garden"),(0,r._x)("We found nothing. Here it isn’t.","The message displayed when no themes were found.","tumblr-theme-garden"),(0,r._x)("Couldn’t find that. Please, don’t be upset. Please.","The message displayed when no themes were found.","tumblr-theme-garden"),(0,r._x)("Sincerely, we found nothing.","The message displayed when no themes were found.","tumblr-theme-garden"),(0,r._x)("Nothing to see here.","The message displayed when no themes were found.","tumblr-theme-garden"),(0,r._x)("If you were looking for nothing, congrats, you found it.","The message displayed when no themes were found.","tumblr-theme-garden")],a=Math.floor(Math.random()*t.length);return(0,e.createElement)("p",{className:"no-themes",id:"tumblr-no-themes"},t[a])},E=({theme:{activate_url:t,id:a,thumbnail:n,title:s},handleDetailsClick:m,isActive:h})=>{const l=`tumblr-theme-garden-theme-details-${a}`;return(0,e.createElement)("article",{className:"tumblr-theme"},(0,e.createElement)("header",{className:"tumblr-theme-header"},(0,e.createElement)("div",{className:"tumblr-theme-title-wrapper"},(0,e.createElement)("span",{className:"tumblr-theme-title"},s))),(0,e.createElement)("div",{className:"tumblr-theme-content"},(0,e.createElement)("button",{className:"tumblr-theme-details",onClick:m,value:a,id:l},(0,e.createElement)("label",{htmlFor:l},(0,e.createElement)("span",{className:"tumblr-theme-detail-button"},(0,r._x)("Theme details","Text on a button that will show more information about a Tumblr theme","tumblr-theme-garden"))),(0,e.createElement)("img",{src:n,alt:""})),(0,e.createElement)("div",{className:"tumblr-theme-footer"},h?(0,e.createElement)("span",null,"Active!"):(0,e.createElement)("a",{className:"rainbow-button",href:t},"Activate"))))},b=(0,s.compose)((0,n.withSelect)((e=>({themes:e("tumblr-theme-garden/theme-garden-store").getThemes(),isFetchingThemes:e("tumblr-theme-garden/theme-garden-store").getIsFetchingThemes(),activeTheme:e("tumblr-theme-garden/theme-garden-store").getActiveTheme()}))),(0,n.withDispatch)((e=>({closeOverlay:()=>e("tumblr-theme-garden/theme-garden-store").closeOverlay()}))))((({themes:a,isFetchingThemes:r,fetchThemeById:n,activeTheme:s})=>{const[m,h]=(0,t.useState)(a);(0,t.useEffect)((()=>{h(a)}),[a]);const l=async({currentTarget:{value:e}})=>{const t=new URL(window.location.href),a=new URLSearchParams(t.search);a.append("theme",e),t.search=a.toString(),await n(e),window.history.pushState({},"",t.toString())};return r?(0,e.createElement)("div",{className:"loading-content"},(0,e.createElement)("span",{className:"spinner"})):0===m.length?(0,e.createElement)(u,null):(0,e.createElement)("div",{className:"tumblr-themes"},s&&(0,e.createElement)(E,{theme:s,handleDetailsClick:l,isActive:!0}),a.map((t=>(0,e.createElement)(E,{theme:t,handleDetailsClick:l,key:t.title}))))}));var T=a(942),p=a.n(T);const w=(0,s.compose)((0,n.withSelect)((e=>({themes:e("tumblr-theme-garden/theme-garden-store").getThemes(),isOverlayOpen:e("tumblr-theme-garden/theme-garden-store").getIsOverlayOpen(),isFetchingTheme:e("tumblr-theme-garden/theme-garden-store").getIsFetchingTheme(),themeDetails:e("tumblr-theme-garden/theme-garden-store").getThemeDetails()}))),(0,n.withDispatch)((e=>({closeOverlay:()=>e("tumblr-theme-garden/theme-garden-store").closeOverlay()}))))((({themes:a,isOverlayOpen:n,isFetchingTheme:s,closeOverlay:m,themeDetails:h,fetchThemeById:l})=>{const c=(0,t.useCallback)((()=>{const e=new URL(window.location.href),t=new URLSearchParams(e.search);t.delete("theme"),e.search=t.toString(),window.history.pushState({},"",e.toString()),m()}),[m]),o=(0,t.useCallback)((()=>s||!h?(0,e.createElement)("div",{className:"loading-content wp-clearfix"},(0,e.createElement)("span",{className:"spinner"})):(0,e.createElement)("div",{className:"theme-about wp-clearfix"},(0,e.createElement)("div",{className:"theme-screenshots"},(0,e.createElement)("div",{className:"screenshot"},(0,e.createElement)("img",{src:h.screenshots[0],alt:""}))),(0,e.createElement)("div",{className:"theme-info"},(0,e.createElement)("h2",{className:"theme-name"},h.title),(0,e.createElement)("div",{dangerouslySetInnerHTML:{__html:h.description}})))),[h,s]),i=(0,t.useCallback)((async e=>{const t=new URL(window.location.href),r=new URLSearchParams(t.search),n=a[e].id;r.delete("theme"),r.append("theme",n),t.search=r.toString(),await l(n),window.history.pushState({},"",t.toString())}),[a,l]),d=(0,t.useCallback)((()=>{const t=a.findIndex((e=>e.id===h.id)),n=-1===t||0===t,s=-1===t||t===a.length-1;return(0,e.createElement)("div",{className:"theme-header"},(0,e.createElement)("button",{className:p()("left","dashicons","dashicons-no",{disabled:n}),disabled:n,onClick:()=>i(t-1)},(0,e.createElement)("span",{className:"screen-reader-text"},(0,r._x)("Show previous theme","label for a button that will navigate to previous theme","tumblr-theme-garden"))),(0,e.createElement)("button",{className:p()("right","dashicons","dashicons-no",{disabled:s}),disabled:s,onClick:()=>i(t+1)},(0,e.createElement)("span",{className:"screen-reader-text"},(0,r._x)("Show next theme","label for a button that will navigate to next theme","tumblr-theme-garden"))),(0,e.createElement)("button",{className:"close dashicons dashicons-no",onClick:c},(0,e.createElement)("span",{className:"screen-reader-text"},(0,r._x)("Close theme details overlay","label for a button that will close an overlay","tumblr-theme-garden"))))}),[h,a,i,c]);return n&&h?(0,e.createElement)("div",{className:"theme-overlay",id:"tumblr-theme-overlay"},(0,e.createElement)("div",{className:"theme-backdrop"}),(0,e.createElement)("div",{className:"theme-wrap wp-clearfix"},d(),o())):null})),y=(0,s.compose)((0,n.withSelect)((e=>({logoUrl:e("tumblr-theme-garden/theme-garden-store").getLogoUrl(),selectedCategory:e("tumblr-theme-garden/theme-garden-store").getSelectedCategory(),search:e("tumblr-theme-garden/theme-garden-store").getSearch()}))),(0,n.withDispatch)((e=>({beforeFetchThemes:()=>e("tumblr-theme-garden/theme-garden-store").beforeFetchThemes(),fetchThemes:t=>e("tumblr-theme-garden/theme-garden-store").fetchThemes(t),searchThemes:t=>e("tumblr-theme-garden/theme-garden-store").searchThemes(t),receiveThemes:(t,a,r)=>e("tumblr-theme-garden/theme-garden-store").receiveThemes(t,a,r),beforeFetchTheme:()=>e("tumblr-theme-garden/theme-garden-store").beforeFetchTheme(),fetchTheme:t=>e("tumblr-theme-garden/theme-garden-store").fetchTheme(t),receiveTheme:(t,a)=>e("tumblr-theme-garden/theme-garden-store").receiveTheme(t,a),closeOverlay:()=>e("tumblr-theme-garden/theme-garden-store").closeOverlay()}))))((({logoUrl:a,beforeFetchThemes:n,fetchThemes:s,receiveThemes:m,searchThemes:h,beforeFetchTheme:l,fetchTheme:c,receiveTheme:o,closeOverlay:i,search:d,selectedCategory:u})=>{const E=(0,t.useCallback)((async e=>{n();const t=await s(e);m(t,e,"")}),[n,m,s]),T=(0,t.useCallback)((async e=>{n();const t=await h(e);m(t,"",e)}),[n,m,h]),p=(0,t.useCallback)((async()=>{const e=new URLSearchParams(window.location.search),t=e.get("category")||"featured",a=e.get("search")||"",r=e.get("theme")||"";if(""!==a&&a!==d?await T(a):""!==t&&t!==u&&await E(t),""!==r){l();const e=await c(r);o(e,r)}else i()}),[u,d,l,i,c,E,T,o]);(0,t.useEffect)((()=>(window.addEventListener("popstate",p),()=>{window.removeEventListener("popstate",p)})),[p]);const y=(0,t.useCallback)((async e=>{l();const t=await c(e);o(t,e)}),[l,o,c]);return(0,e.createElement)("div",{className:"wrap"},(0,e.createElement)("h1",{className:"wp-heading-inline",id:"theme-garden-heading"},(0,e.createElement)("img",{className:"tumblr-logo-icon",src:a,alt:""}),(0,e.createElement)("span",null,(0,r.__)("Tumblr Themes","tumblr-theme-garden"))),(0,e.createElement)(g,{fetchThemesByCategory:E,fetchThemesByQuery:T}),(0,e.createElement)(b,{fetchThemeById:y}),(0,e.createElement)(w,{fetchThemeById:y}))})),f=document.getElementById("tumblr-theme-garden");f?(0,t.createRoot)(f).render((0,e.createElement)(y,null)):console.error("Failed to find the root element for the settings panel.")})()})();